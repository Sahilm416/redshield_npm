{"version":3,"sources":["../../../src/actions/auth.ts"],"sourcesContent":["\"use server\";\r\nimport { cookies } from \"next/headers\";\r\n\r\nexport const getEnv = async () => {\r\n  return process.env.Red_key!;\r\n};\r\n\r\nexport const getProject = async () => {\r\n  try {\r\n    const key = await getEnv();\r\n    if (!key) {\r\n      throw new Error(\"please provide a key\");\r\n    }\r\n    const res = await fetch(\r\n      \"https://redshield.vercel.app/api/service/getProject\",\r\n      {\r\n        cache: 'no-store',\r\n        headers: {\r\n          Authorization: key,\r\n        },\r\n      }\r\n    );\r\n\r\n    const response = await res.json();\r\n\r\n    if (response.status) {\r\n      return {\r\n        status: true,\r\n        message: response.message,\r\n        project_name: response.project_name,\r\n        project_id: response.project_id,\r\n      };\r\n    }\r\n    return {\r\n      status: false,\r\n      message: response.message,\r\n      project_id:\"\",\r\n      project_name:\"\"\r\n    };\r\n  } catch (error) {\r\n    console.log(error);\r\n    return {\r\n      status: false,\r\n      message: \"something went wrong\",\r\n      project_id:\"\",\r\n      project_name:\"\"\r\n    }\r\n  }\r\n};\r\n\r\nexport const verifyJWT = async ({ token }: { token: string | undefined }) => {\r\n  try {\r\n    const key = await getEnv();\r\n    const res = await fetch(\"https://redshield.vercel.app/api/service/verify\", {\r\n      method: \"POST\",\r\n      cache: \"no-store\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: key,\r\n      },\r\n      body: JSON.stringify({\r\n        token: token,\r\n      }),\r\n    });\r\n\r\n    const response = await res.json();\r\n    return response\r\n  } catch (error) {\r\n    console.log(error)\r\n    return {\r\n      status: false,\r\n      message: \"something went wrong\"\r\n    }\r\n  }\r\n};\r\n\r\nexport const getSession = async () => {\r\n  const store = cookies();\r\n\r\n  const token = store.get(\"_auth_token\")?.value;\r\n  if (!token) {\r\n    return {\r\n      status: false,\r\n      message: \"session token not found\",\r\n    };\r\n  }\r\n\r\n  try {\r\n    const res = await verifyJWT({token: token});\r\n    return {\r\n      status: res.status,\r\n      message: res.message,\r\n      data: res.data,\r\n    };\r\n  } catch (error) {\r\n    console.log(\"error verifying token: \" + error);\r\n\r\n    return {\r\n      status: false,\r\n      message: \"token signature invalid\",\r\n    };\r\n  }\r\n};\r\n\r\nexport const LogOut = async () => {\r\n  const store = cookies();\r\n  store.delete(\"_auth_token\");\r\n  return {\r\n    status: true,\r\n    message: \"logged out successfully\",\r\n  };\r\n};\r\n\r\nexport const resetPassword = async () => {};"],"mappings":";AACA,SAAS,eAAe;AAEjB,MAAM,SAAS,YAAY;AAChC,SAAO,QAAQ,IAAI;AACrB;AAEO,MAAM,aAAa,YAAY;AACpC,MAAI;AACF,UAAM,MAAM,MAAM,OAAO;AACzB,QAAI,CAAC,KAAK;AACR,YAAM,IAAI,MAAM,sBAAsB;AAAA,IACxC;AACA,UAAM,MAAM,MAAM;AAAA,MAChB;AAAA,MACA;AAAA,QACE,OAAO;AAAA,QACP,SAAS;AAAA,UACP,eAAe;AAAA,QACjB;AAAA,MACF;AAAA,IACF;AAEA,UAAM,WAAW,MAAM,IAAI,KAAK;AAEhC,QAAI,SAAS,QAAQ;AACnB,aAAO;AAAA,QACL,QAAQ;AAAA,QACR,SAAS,SAAS;AAAA,QAClB,cAAc,SAAS;AAAA,QACvB,YAAY,SAAS;AAAA,MACvB;AAAA,IACF;AACA,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,SAAS,SAAS;AAAA,MAClB,YAAW;AAAA,MACX,cAAa;AAAA,IACf;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,IAAI,KAAK;AACjB,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,YAAW;AAAA,MACX,cAAa;AAAA,IACf;AAAA,EACF;AACF;AAEO,MAAM,YAAY,OAAO,EAAE,MAAM,MAAqC;AAC3E,MAAI;AACF,UAAM,MAAM,MAAM,OAAO;AACzB,UAAM,MAAM,MAAM,MAAM,mDAAmD;AAAA,MACzE,QAAQ;AAAA,MACR,OAAO;AAAA,MACP,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,eAAe;AAAA,MACjB;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AAED,UAAM,WAAW,MAAM,IAAI,KAAK;AAChC,WAAO;AAAA,EACT,SAAS,OAAO;AACd,YAAQ,IAAI,KAAK;AACjB,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,SAAS;AAAA,IACX;AAAA,EACF;AACF;AAEO,MAAM,aAAa,YAAY;AACpC,QAAM,QAAQ,QAAQ;AAEtB,QAAM,QAAQ,MAAM,IAAI,aAAa,GAAG;AACxC,MAAI,CAAC,OAAO;AACV,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,SAAS;AAAA,IACX;AAAA,EACF;AAEA,MAAI;AACF,UAAM,MAAM,MAAM,UAAU,EAAC,MAAY,CAAC;AAC1C,WAAO;AAAA,MACL,QAAQ,IAAI;AAAA,MACZ,SAAS,IAAI;AAAA,MACb,MAAM,IAAI;AAAA,IACZ;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,IAAI,4BAA4B,KAAK;AAE7C,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,SAAS;AAAA,IACX;AAAA,EACF;AACF;AAEO,MAAM,SAAS,YAAY;AAChC,QAAM,QAAQ,QAAQ;AACtB,QAAM,OAAO,aAAa;AAC1B,SAAO;AAAA,IACL,QAAQ;AAAA,IACR,SAAS;AAAA,EACX;AACF;AAEO,MAAM,gBAAgB,YAAY;AAAC;","names":[]}