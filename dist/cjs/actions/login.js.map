{"version":3,"sources":["../../../src/actions/login.ts"],"sourcesContent":["\"use server\";\r\nimport { cookies } from \"next/headers\";\r\nimport { getEnv } from \"./auth\";\r\n\r\nexport const LoginUser = async ({\r\n  email,\r\n  password,\r\n  project_id,\r\n}: {\r\n  email: string;\r\n  password: string;\r\n  project_id: string;\r\n}) => {\r\n  const key = await getEnv();\r\n\r\n  try {\r\n    const res = await fetch(\"https://redshield.vercel.app/api/service/login\", {\r\n      method: \"POST\",\r\n      cache: \"no-store\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n        Authorization: key,\r\n      },\r\n      body: JSON.stringify({\r\n        email: email.trim(),\r\n        password: password.trim(),\r\n        project_id: project_id,\r\n      }),\r\n    });\r\n    const response = (await res.json()) as {\r\n      status: boolean;\r\n      message: string;\r\n      token: string;\r\n    };\r\n    if(response.status){\r\n      setJWTcookie({token: response.token});\r\n    }\r\n    return {\r\n      status: response.status || false,\r\n      message: response.message || \"something went wrong\",\r\n    };\r\n  } catch (error) {\r\n    console.log(error);\r\n    return {\r\n      status: false,\r\n      message: \"something went wrong\",\r\n    };\r\n  }\r\n};\r\n\r\nconst setJWTcookie = ({ token }: { token: string }) => {\r\n  const cookieStore = cookies();\r\n  const date = new Date();\r\n  date.setTime(date.getTime() + 7 * 24 * 60 * 60 * 1000);\r\n\r\n  cookieStore.set(\"_auth_token\", token, {\r\n    expires: date,\r\n    httpOnly: true,\r\n    sameSite: true,\r\n  });\r\n};"],"mappings":";;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,qBAAwB;AACxB,kBAAuB;AAEhB,MAAM,YAAY,OAAO;AAAA,EAC9B;AAAA,EACA;AAAA,EACA;AACF,MAIM;AACJ,QAAM,MAAM,UAAM,oBAAO;AAEzB,MAAI;AACF,UAAM,MAAM,MAAM,MAAM,kDAAkD;AAAA,MACxE,QAAQ;AAAA,MACR,OAAO;AAAA,MACP,SAAS;AAAA,QACP,gBAAgB;AAAA,QAChB,eAAe;AAAA,MACjB;AAAA,MACA,MAAM,KAAK,UAAU;AAAA,QACnB,OAAO,MAAM,KAAK;AAAA,QAClB,UAAU,SAAS,KAAK;AAAA,QACxB;AAAA,MACF,CAAC;AAAA,IACH,CAAC;AACD,UAAM,WAAY,MAAM,IAAI,KAAK;AAKjC,QAAG,SAAS,QAAO;AACjB,mBAAa,EAAC,OAAO,SAAS,MAAK,CAAC;AAAA,IACtC;AACA,WAAO;AAAA,MACL,QAAQ,SAAS,UAAU;AAAA,MAC3B,SAAS,SAAS,WAAW;AAAA,IAC/B;AAAA,EACF,SAAS,OAAO;AACd,YAAQ,IAAI,KAAK;AACjB,WAAO;AAAA,MACL,QAAQ;AAAA,MACR,SAAS;AAAA,IACX;AAAA,EACF;AACF;AAEA,MAAM,eAAe,CAAC,EAAE,MAAM,MAAyB;AACrD,QAAM,kBAAc,wBAAQ;AAC5B,QAAM,OAAO,oBAAI,KAAK;AACtB,OAAK,QAAQ,KAAK,QAAQ,IAAI,IAAI,KAAK,KAAK,KAAK,GAAI;AAErD,cAAY,IAAI,eAAe,OAAO;AAAA,IACpC,SAAS;AAAA,IACT,UAAU;AAAA,IACV,UAAU;AAAA,EACZ,CAAC;AACH;","names":[]}